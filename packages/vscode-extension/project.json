{
  "name": "vscode-extension",
  "$schema": "../../node_modules/nx/schemas/project-schema.json",
  "projectType": "application",
  "sourceRoot": "packages/vscode-extension/src",
  "prefix": "pretext",
  "targets": {
    "build": {
      "executor": "nx:run-commands",
      "dependsOn": [
        "@pretextbook/completions:build",
        "@pretextbook/format:vite:build",
        "@pretextbook/visual-editor:vite:build",
        "copy-assets"
      ],
      "options": {
        "cwd": "packages/vscode-extension",
        "command": "npm run esbuild-base -- --minify"
      },
      "configurations": {
        "development": {
          "command": "npm run esbuild"
        },
        "production": {
          "command": "npm run vscode:prepublish"
        }
      },
      "cache": true,
      "inputs": [
        "default",
        "^default",
        {
          "externalDependencies": ["esbuild"]
        }
      ],
      "outputs": ["{workspaceRoot}/dist/vscode-extension"],
      "metadata": {
        "technologies": ["esbuild", "vscode"],
        "description": "Builds the VS Code extension with esbuild"
      }
    },
    "build:dev": {
      "executor": "nx:run-commands",
      "dependsOn": [
        "@pretextbook/completions:build",
        "@pretextbook/format:vite:build",
        "@pretextbook/visual-editor:vite:build"
      ],
      "options": {
        "cwd": "packages/vscode-extension",
        "command": "npm run esbuild"
      },
      "cache": false,
      "metadata": {
        "description": "Builds the VS Code extension in development mode with sourcemaps"
      }
    },
    "build:watch": {
      "executor": "nx:run-commands",
      "dependsOn": [
        "@pretextbook/completions:build",
        "@pretextbook/format:vite:build",
        "@pretextbook/visual-editor:vite:build"
      ],
      "options": {
        "cwd": "packages/vscode-extension",
        "command": "npm run esbuild-watch"
      },
      "isBackground": true,
      "cache": false,
      "metadata": {
        "description": "Builds the VS Code extension in watch mode"
      }
    },
    "typecheck": {
      "executor": "nx:run-commands",
      "dependsOn": ["^typecheck"],
      "options": {
        "cwd": "packages/vscode-extension",
        "command": "npm run test-compile"
      },
      "cache": true,
      "inputs": ["default", "^default"],
      "metadata": {
        "technologies": ["typescript"],
        "description": "Type-checks the VS Code extension source"
      }
    },
    "lint": {
      "executor": "nx:noop",
      "metadata": {
        "technologies": ["eslint"],
        "description": "Lints the VS Code extension source code (currently disabled)"
      }
    },
    "test": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "packages/vscode-extension",
        "command": "npm run test"
      },
      "cache": true,
      "inputs": ["default", "^default"],
      "metadata": {
        "technologies": ["vscode-test"],
        "description": "Tests the VS Code extension"
      }
    },
    "package": {
      "executor": "nx:run-commands",
      "dependsOn": ["build"],
      "options": {
        "cwd": "packages/vscode-extension",
        "command": "npm run package"
      },
      "metadata": {
        "description": "Packages the VS Code extension for distribution"
      }
    },
    "copy-assets": {
      "executor": "nx:run-commands",
      "options": {
        "commands": [
          "mkdir -p ../../dist/vscode-extension",
          "cp package.json ../../dist/vscode-extension/",
          "jq 'del(.scripts) | del(.devDependencies) | del(.dependencies[\"@pretextbook/format\"]) | del(.dependencies[\"@pretextbook/completions\"])' ../../dist/vscode-extension/package.json > ../../dist/vscode-extension/package.json.tmp && mv ../../dist/vscode-extension/package.json.tmp ../../dist/vscode-extension/package.json",
          "cp ../../LICENSE ../../dist/vscode-extension/",
          "cp logo.png ../../dist/vscode-extension/",
          "cp language-configuration.json ../../dist/vscode-extension/",
          "cp -r assets ../../dist/vscode-extension/",
          "cp -r snippets ../../dist/vscode-extension/",
          "cp -r syntaxes ../../dist/vscode-extension/"
        ],
        "cwd": "packages/vscode-extension",
        "parallel": false
      },
      "cache": true,
      "inputs": [
        "{projectRoot}/package.json",
        "{workspaceRoot}/LICENSE",
        "{projectRoot}/logo.png",
        "{projectRoot}/language-configuration.json",
        "{projectRoot}/assets/**/*",
        "{projectRoot}/snippets/**/*",
        "{projectRoot}/syntaxes/**/*"
      ],
      "outputs": [
        "{workspaceRoot}/dist/vscode-extension/package.json",
        "{workspaceRoot}/dist/vscode-extension/LICENSE",
        "{workspaceRoot}/dist/vscode-extension/logo.png",
        "{workspaceRoot}/dist/vscode-extension/language-configuration.json",
        "{workspaceRoot}/dist/vscode-extension/assets",
        "{workspaceRoot}/dist/vscode-extension/snippets",
        "{workspaceRoot}/dist/vscode-extension/syntaxes"
      ],
      "metadata": {
        "description": "Copies assets and configuration files to the dist folder"
      }
    },
    "build-deps": {
      "executor": "nx:noop",
      "dependsOn": ["^build"],
      "options": {},
      "configurations": {}
    },
    "watch-deps": {
      "executor": "nx:run-commands",
      "dependsOn": ["build-deps"],
      "options": {
        "command": "npx nx watch --projects vscode-extension --includeDependentProjects -- npx nx build-deps vscode-extension"
      },
      "isBackground": true,
      "continuous": true,
      "cache": false
    }
  },
  "tags": ["npm:private"],
  "implicitDependencies": []
}
